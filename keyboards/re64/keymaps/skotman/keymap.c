/* Copyright 2020 kushima8
 * Copyright 2020 utubo
 * Copyright 2021 Skotman
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */


#include QMK_KEYBOARD_H

enum layers{
    _BASE,
    _RAISE,
    _NUM,
    _FN
};
enum layercode{
    BASE = SAFE_RANGE,
    RAISE,
    NUMPAD,
    FN
};
#define BASE DF(_BASE)
#define RAISE TG(_RAISE)
#define NUMPAD TG(_NUM)
#define FN MO(_FN)
const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
/*
 * Base layer: BASE
 *
 *,-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
 *| ESC   |   1   |   2   |   3   |   4   |   5   |   6   |             |   7   |   8   |   9   |   0   |   -   |   +   |   `   |BCKSPC |
 *|-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
 *| TAB   |   Q   |   W   |   E   |   R   |   T   |                     |   Y   |   U   |   I   |   O   |   P   |   [   |   ]   |   \   |
 *|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------+-------|
 *| ??    |   A   |   S   |   D   |   F   |   G   |                     |   H   |   J   |   K   |   L   |   ;   |   '   | ENTER |
 *|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------|
 *| SHIFT |   Z   |   X   |   C   |   V   |   B   |                     |   N   |   M   |   ,   |   .   |   /   | RSHFT |  FN   |
 *|-------+-------+-------+-------+-------+-------+-------+     |-------+-------+-------+-------+-------+-------+-------+-------|
 *| CTRL  |  FN   |   ALT |       | SPACE | SPACE | RAISE |     | RAISE | SPACE | SPACE |       | RALT  | RGUI  |
 *|-------+-------+-------+       +-------+-------+-------+     |-------+-------+-------|       |-------+-------|
 *
 */

    [_BASE] = LAYOUT(
 //,-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
     KC_ESC, KC_1  , KC_2  , KC_3  , KC_4  , KC_5  , KC_6  ,                KC_7 , KC_8  , KC_9  , KC_0  ,KC_MINS,KC_EQL , KC_GRV,KC_BSPC,
 //|-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
    KC_TAB , KC_Q  , KC_W  , KC_E  , KC_R  , KC_T  ,                        KC_Y , KC_U  , KC_I  , KC_O  , KC_P  ,KC_LBRC,KC_RBRC,KC_BSLS,
 //|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------+-------|
    KC_CAPS, KC_A  , KC_S  , KC_D  , KC_F  , KC_G  ,                        KC_H , KC_J  , KC_K  , KC_L  ,KC_SCLN,KC_QUOT, KC_ENT,
 //|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------|
    KC_LSFT, KC_Z  , KC_X  , KC_C  , KC_V  , KC_B  ,                       KC_N  , KC_M  ,KC_COMM, KC_DOT,KC_SLSH,KC_RSFT,  FN   ,
 //|-------+-------+-------+-------+-------+-------+-------+     |-------+-------+-------+-------+-------+-------+-------+-------|
    KC_LCTL,  FN   ,KC_LALT        , KC_SPC, KC_SPC, NUMPAD,      RAISE  , KC_SPC, KC_SPC,        KC_RALT,KC_RGUI),
 //|-------+-------+-------+       +-------+-------+-------+     |-------+-------+-------|       |-------+-------|

/*
 * Layer: RAISE
 *
 *,-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
 *| ESC   |   1   |   2   |   3   |   4   |   5   |   6   |             |   7   |   8   |   9   |   0   |   -   |   +   |   `   |BCKSPC |
 *|-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
 *| TAB   |   Q   |   W   |   E   |   R   |   T   |                     |   Y   |   U   |   I   |   O   |   P   |   [   |   ]   |   \   |
 *|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------+-------|
 *| ??    |   A   |   S   |   D   |   F   |   G   |                     |   H   |   J   |   K   |   L   |   ;   |   '   | ENTER |
 *|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------|
 *| SHIFT |   Z   |   X   |   C   |   V   |   B   |                     |   N   |   M   |   ,   |   .   |   /   | RSHFT |  FN   |
 *|-------+-------+-------+-------+-------+-------+-------+     |-------+-------+-------+-------+-------+-------+-------+-------|
 *| CTRL  |  FN   |   ALT |       | SPACE | SPACE | RAISE |     | RAISE | SPACE | SPACE |       | RALT  | RGUI  |
 *|-------+-------+-------+       +-------+-------+-------+     |-------+-------+-------|       |-------+-------|
 *
 */
    [_RAISE] = LAYOUT(
 //,-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
     KC_ESC, KC_1  , KC_2  , KC_3  , KC_4  , KC_5  , KC_6  ,                KC_7 , KC_8  , KC_9  , KC_0  ,KC_MINS,KC_EQL , KC_GRV,KC_BSPC,
 //|-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
    KC_TAB , KC_Q  , KC_W  , KC_E  , KC_R  , KC_T  ,                        KC_Y , KC_U  , KC_I  , KC_O  , KC_P  ,KC_LBRC,KC_RBRC,KC_BSLS,
 //|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------+-------|
    KC_CAPS, KC_A  , KC_S  , KC_D  , KC_F  , KC_G  ,                        KC_H , KC_J  , KC_K  , KC_L  ,KC_SCLN,KC_QUOT, KC_ENT,
 //|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------|
    KC_LSFT, KC_Z  , KC_X  , KC_C  , KC_V  , KC_B  ,                       KC_N  , KC_M  ,KC_COMM, KC_DOT,KC_SLSH,KC_RSFT,  FN   ,
 //|-------+-------+-------+-------+-------+-------+-------+     |-------+-------+-------+-------+-------+-------+-------+-------|
    KC_LCTL,  FN   ,KC_LALT        , KC_SPC, KC_SPC, NUMPAD,      RAISE  , KC_SPC, KC_SPC,        KC_RALT,KC_RGUI
 //|-------+-------+-------+       +-------+-------+-------+     |-------+-------+-------|       |-------+-------|
    ),


/*
 * Layer: NUM
 *
 *,-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
 *| ESC   |   1   |   2   |   3   |   4   |   5   |   6   |             |   7   |   8   |   9   |   0   |   -   |   +   |   `   |BCKSPC |
 *|-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
 *| TAB   | NUM 7 | NUM 8 | NUM 9 |   *   |   +   |                     |   Y   |   U   |   I   |   O   |   P   |   [   |   ]   |   \   |
 *|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------+-------|
 *|       | NUM 4 | NUM 5 | NUM 6 |   /   |   G   |                     |   H   |   J   |   K   |   L   |   ;   |   '   | ENTER |
 *|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------|
 *| SHIFT | NUM 1 | NUM 2 | NUM 3 |   V   |   B   |                     |   N   |   M   |   ,   |   .   |   /   | RSHFT |  FN   |
 *|-------+-------+-------+-------+-------+-------+-------+     |-------+-------+-------+-------+-------+-------+-------+-------|
 *|NUMLOCK|  FN   | NUM 0 |       | SPACE | SPACE | RAISE |     | RAISE | SPACE | SPACE |       | RALT  | RGUI  |
 *|-------+-------+-------+       +-------+-------+-------+     |-------+-------+-------|       |-------+-------|
 *
 */
    [_NUM] = LAYOUT(
 //,-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
    XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,KC_LPRN,KC_RPRN,XXXXXXX,              XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,
 //|-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
    XXXXXXX, KC_P7 , KC_P8 , KC_P9 ,KC_PAST,KC_PPLS,                      XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,
 //|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------+-------|
    XXXXXXX, KC_P4 , KC_P5 , KC_P6 ,KC_PSLS,KC_PMNS,                        KC_H ,KC_LEFT,KC_DOWN,KC_RGHT,XXXXXXX,XXXXXXX,XXXXXXX,
 //|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------|
    XXXXXXX, KC_P1 , KC_P2 , KC_P3 ,KC_PDOT,KC_PEQL,                      XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,XXXXXXX,  FN   ,
 //|-------+-------+-------+-------+-------+-------+-------+     |-------+-------+-------+-------+-------+-------+-------+-------|
    KC_NLCK,  FN   ,KC_P0          , KC_SPC,KC_PENT, NUMPAD,      RAISE  ,XXXXXXX,XXXXXXX,        XXXXXXX,XXXXXXX
 //|-------+-------+-------+       +-------+-------+-------+     |-------+-------+-------|       |-------+-------|
    ),
/*
 * Layer: FN
 *
 *,-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
 *|       |   F1  |   F2  |  F3   |  F4   |  F5   |  F6   |             |  F7   |  F8   |  F9   |  F10  |  F11  |  F12  |  INS  |  DEL  |
 *|-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
 *|       |       |  UP   |       |       |PRTSCRN|                     |       |       |       |       |       |       |       |  INS  |
 *|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------+-------|
 *|       |  LEFT |  DOWN | RIGHT |       |       |                     |  TOG  |  HUI  |  SAI  |  VAI  |       | SCLCK |       |
 *|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------|
 *|       | PREV  | PLAY  | NEXT  |       |       |                     | MODE  |  HUD  |  SAD  |  VAD  |       |  PAUS |  FN   |
 *|-------+-------+-------+-------+-------+-------+-------+     |-------+-------+-------+-------+-------+-------+-------+-------|
 *|       |  FN   |       |       | Home  |  End  |  NUM  |     | RAISE |       |       |       |       |       |
 *|-------+-------+-------+       +-------+-------+-------+     |-------+-------+-------|       |-------+-------|
 *
 */
    [_FN] = LAYOUT(
 //,-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
    _______, KC_F1 , KC_F2 , KC_F3 , KC_F4 ,KC_F5  , KC_F6 ,                KC_F7 , KC_F8, KC_F9 , KC_F10,KC_F11 ,KC_F12 ,_______,KC_DEL ,
 //|-------+-------+-------+-------+-------+-------+-------|             +-------+-------+-------+-------+-------+-------+-------+-------|
    _______,_______,KC_UP  ,_______,_______,KC_PSCR,                      _______,_______,_______,_______,_______,_______,_______,KC_INS,
 //|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------+-------|
    _______,KC_LEFT,KC_DOWN,KC_RGHT,_______,_______,                      RGB_TOG,RGB_HUI,RGB_SAI,RGB_VAI,_______,KC_SLCK,_______,
 //|-------+-------+-------+-------+-------+-------|                     +-------+-------+-------+-------+-------+-------+-------|
    _______,KC_MPRV,KC_MPLY,KC_MNXT,_______,_______,                      RGB_MOD,RGB_HUD,RGB_SAD,RGB_VAD,_______,KC_PAUS,_______,
 //|-------+-------+-------+-------+-------+-------+-------+     |-------+-------+-------+-------+-------+-------+-------+-------|
    _______,_______,_______,        KC_HOME, KC_END,_______,      _______,_______,_______,        KC_RALT,KC_RGUI
 //|-------+-------+-------+       +-------+-------+-------+     |-------+-------+-------|       |-------+-------|
    )
};

#ifdef ENCODER_ENABLE
bool encoder_update_user(uint8_t index, bool clockwise) {
    if (index == 0) {
        // Left rotary
        switch (get_highest_layer(layer_state)) {
            case _BASE:
            case _RAISE:
            case _NUM:
                tap_code(clockwise ? KC_VOLU : KC_VOLD);
                break;
            case _FN:
                tap_code(clockwise ? KC_UP : KC_DOWN);
                break;
            default:
                break;
        };
    } else if (index == 1) {
        // Right rotary Note:Reverse Rotation
        switch (get_highest_layer(layer_state)) {
            case _BASE:
            case _RAISE:
            case _NUM:
                tap_code(clockwise ? A(KC_TAB) : A(S(KC_TAB)));
                break;
            case _FN:
                tap_code(clockwise ? KC_PGUP : KC_PGDN);
                break;
            default:
                break;
        }
    }
	return true;
};
#endif
